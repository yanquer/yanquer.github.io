
<!DOCTYPE HTML>
<!--
	Dopetrope 2.0 by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
			<title>书言</title>
			<meta http-equiv="content-type" content="text/html; charset=utf-8" />
			<meta charset="utf-8" />
			<link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,900,300italic" rel="stylesheet" />
				<link rel="stylesheet" href="/theme/css/pygment.css" />
			<noscript>
				<link rel="stylesheet" href="/theme/css/skel-noscript.css" />
				<link rel="stylesheet" href="/theme/css/style.css" />
				<link rel="stylesheet" href="/theme/css/style-desktop.css" />
			</noscript>
		<link rel="stylesheet" href="/theme/css/alabaster.css" />
		<link rel="stylesheet" href="/theme/css/style-update.css" />
	</head>
	<body class="no-sidebar">
		<!-- Header Wrapper -->
			<div id="header-wrapper">
				<div class="container">
					<div class="row">
						<div class="12u">

							<!-- Header -->
								<section id="header">

									<!-- Logo -->
									<div class="page-home">
										<h1><a href="/">HOME</a></h1>
									</div>

									<!-- Nav -->
									<div class="page-menu">
										<nav id="nav">
											<ul>

												<!-- categories -->
														<li ><a href="/category/ai.html">AI</a></li>
														<li ><a href="/category/an-quan.html">安全</a></li>
														<li ><a href="/category/ban-ben-kong-zhi.html">版本控制</a></li>
														<li  class="active"><a href="/category/cao-zuo-xi-tong.html">操作系统</a></li>
														<li ><a href="/category/chang-yong-gong-ju-shi-yong.html">常用工具使用</a></li>
														<li ><a href="/category/da-shu-ju.html">大数据</a></li>
														<li><a href="/categories.html">More...</a></li>
											</ul>
										</nav>
									</div>
								</section>

						</div>
					</div>
					<div class="row page-head-search">
						<form class="navbar-search" action="/search.html" role="search">
							<!-- <button class="fa-solid fa-magnifying-glass" type="submit"></button> -->
							<button type="submit"></button>
							<input type="text" name="q" id="tipue_search_input" autocomplete="off" placeholder="Search...">
							<!-- <i class="fa-solid fa-magnifying-glass"></i> -->
						</form>
					</div>
  <div class="row page-head page-article persistent">
    <div class="page-head-title">
      <h2>openssl</h2>
    </div>
    <div class="page-head-content">
      By
	  <a href="author/yanque.html">YanQue</a>
      , 09 三月 2024
      , Category:
	  <a href="category/cao-zuo-xi-tong.html">操作系统</a>
    </div>
	<div class="red-line">
    </div>
  </div>
				</div>
			</div>

		<!-- Main Wrapper -->
			<div id="main-wrapper">
				<div class="container">
<div class="row">
	<div class="12u">
			<section>
				<div>
					<div class="row">
						<div class="12u skel-cell-mainContent">
							<!-- Content -->
								<article class="box is-post">
									<div class="post-infos">
										<ul class="tags">
											<li><a class="button" href="category/cao-zuo-xi-tong.html">操作系统</a></li>
												<li><a class="button button-alt" href="tag/linux.html">Linux</a></li>

												<li><a class="button button-alt" href="tag/linuxzhi-ling.html">Linux指令</a></li>

										</ul>
									</div>

									<div class="pennant pennant-alt date">2024-03-09</div>
									<h2>openssl</h2>
									<ul class="simple">
<li>常用指令可见: <a class="reference external" href="https://www.gy328.com/ref/docs/openssl.html">https://www.gy328.com/ref/docs/openssl.html</a>
若无法访问可见: <em>OpenSSL参考手册 &lt;/resources/pdf/OpenSSL 参考手册 &amp; openssl 快速入门 - 菜鸟教程.pdf&gt;</em></li>
<li>官网: <a class="reference external" href="https://www.openssl.org">https://www.openssl.org</a></li>
</ul>
<p>强大的安全套接字层密码库, 利用它的随机功能来生成可以用作密码的随机字母字符串:</p>
<pre class="literal-block">
openssl rand -base64 10
# nU9LlHO5nsuUvw==

# standard 标准
# digest 消化 摘要
# cipher 加密
</pre>
<p>OpenSSL有两种运行模式：交互模式和批处理模式。</p>
<p>直接输入openssl回车进入交互模式，输入带命令选项的openssl进入批处理模式。</p>
<p>OpenSSL整个软件包大概可以分成三个主要的功能部分：密码算法库、SSL协议库以及应用程序。OpenSSL的目录结构自然也是围绕这三个功能部分进行规划的。</p>
<div class="section" id="section-1">
<h2>对称加密算法</h2>
<p>OpenSSL一共提供了8种对称加密算法，其中7种是分组加密算法，仅有的一种流加密算法是RC4。这7种分组加密算法分别是AES、DES、Blowfish、CAST、IDEA、RC2、RC5，都支持电子密码本模式（ECB）、加密分组链接模式（CBC）、加密反馈模式（CFB）和输出反馈模式（OFB）四种常用的分组密码加密模式。其中，AES使用的加密反馈模式（CFB）和输出反馈模式（OFB）分组长度是128位，其它算法使用的则是64位。事实上，DES算法里面不仅仅是常用的DES算法，还支持三个密钥和两个密钥3DES算法。</p>
</div>
<div class="section" id="section-2">
<h2>非对称加密算法</h2>
<p>OpenSSL一共实现了4种非对称加密算法，包括DH算法、RSA算法、DSA算法和椭圆曲线算法（EC）。DH算法一般用户密钥交换。RSA算法既可以用于密钥交换，也可以用于数字签名，当然，如果你能够忍受其缓慢的速度，那么也可以用于数据加密。DSA算法则一般只用于数字签名。</p>
</div>
<div class="section" id="section-3">
<h2>信息摘要算法</h2>
<p>OpenSSL实现了5种信息摘要算法，分别是MD2、MD5、MDC2、SHA（SHA1）和RIPEMD。SHA算法事实上包括了SHA和SHA1两种信息摘要算法，此外，OpenSSL还实现了DSS标准中规定的两种信息摘要算法DSS和DSS1。</p>
</div>
<div class="section" id="section-4">
<h2>密钥和证书管理</h2>
<p>密钥和证书管理是PKI的一个重要组成部分，OpenSSL为之提供了丰富的功能，支持多种标准。</p>
<p>首先，OpenSSL实现了ASN.1的证书和密钥相关标准，提供了对证书、公钥、私钥、证书请求以及CRL等数据对象的DER、PEM和BASE64的编解码功能。OpenSSL提供了产生各种公开密钥对和对称密钥的方法、函数和应用程序，同时提供了对公钥和私钥的DER编解码功能。并实现了私钥的PKCS#12和PKCS#8的编解码功能。OpenSSL在标准中提供了对私钥的加密保护功能，使得密钥可以安全地进行存储和分发。</p>
<p>在此基础上，OpenSSL实现了对证书的X.509标准编解码、PKCS#12格式的编解码以及PKCS#7的编解码功能。并提供了一种文本数据库，支持证书的管理功能，包括证书密钥产生、请求产生、证书签发、吊销和验证等功能。</p>
<p>事实上，OpenSSL提供的CA应用程序就是一个小型的证书管理中心（CA），实现了证书签发的整个流程和证书管理的大部分机制。</p>
<p><cite>&lt;openssl用法详解&gt; https://www.cnblogs.com/yangxiaolan/p/6256838.html</cite></p>
<p>使用openssl生成密码:</p>
<pre class="literal-block">
┌──(yanque㉿3675b5ebb8ce)-[~/test]
└─$ openssl passwd -1 -salt admin 123456
$1$admin$LClYcRe.ee8dQwgrFc5nz.
</pre>
<p>其中:</p>
<pre class="literal-block">
passwd 表示生成密码
-1 表示使用md5算法
-salt 表示随机使用一个字符串加盐
admin 用户名明文
123456 用户密码明文
</pre>
</div>
<div class="section" id="section-5">
<h2>命令说明</h2>
<ul class="simple">
<li>req:生成证书签名请求(CSR)。用于申请证书。</li>
<li>x509:X.509证书格式相关操作。如签名CSR生成证书、签名其他证书等。</li>
<li>genrsa:生成RSA私钥和公钥。</li>
</ul>
<p>举个例子:</p>
<pre class="literal-block">
# 生成2048位RSA私钥
openssl genrsa -out key.pem 2048

# 生成CSR
openssl req -out csr.pem -newkey rsa:2048 -nodes -keyout key.pem

# 使用CA证书和私钥签名CSR生成证书
openssl x509 -req -in csr.pem -CA ca.crt -CAkey ca.key -out cert.pem
</pre>
<p>通用选项:</p>
<table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-i<var>n</var></span></kbd></td>
<td>从哪个文件读取输入, 比如 server.key</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-o<var>ut</var></span></kbd></td>
<td>指定将结果输出到文件</td></tr>
</tbody>
</table>
<div class="section" id="genrsa">
<h3>genrsa</h3>
<p>生成RSA私钥和公钥</p>
<table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-d<var>es3</var></span></kbd></td>
<td>指定使用des3算法</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-a<var>es256</var></span></kbd></td>
<td>使用aes256对密钥文件进行对称加密</td></tr>
</tbody>
</table>
</div>
<div class="section" id="rsa">
<h3>rsa</h3>
<table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-p<var>ubout</var></span></kbd></td>
<td>当需要根据私钥生成公钥时, 使用此选项</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-a<var>es256</var></span></kbd></td>
<td>使用aes256对密钥文件进行对称加密</td></tr>
</tbody>
</table>
</div>
<div class="section" id="req">
<h3>req</h3>
<p>请求生成证书签名请求文件</p>
<table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-n<var>ew</var></span></kbd></td>
<td>指定新生成证书签名请求文件</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-k<var>ey</var></span></kbd></td>
<td>指定签名时, 使用的私钥, 如server.key</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-k<var>eyout</var></span></kbd></td>
<td>直接一步生成证书或证书请求与密钥时, 使用此选项指定密钥名称</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-n<var>odes</var></span></kbd></td>
<td>指定密钥文件不加密</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-p<var>assout</var></span></kbd></td>
<td>若需要加密, 命令行指定密码, 格式: <tt class="docutils literal">pass:密码</tt> , 否则可在交互式界面手动输入</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-n<var>ewkey</var></span></kbd></td>
<td>指定算法, 格式: <tt class="docutils literal"><span class="pre">&lt;algorithm&gt;:&lt;bits&gt;</span></tt>,
即 <tt class="docutils literal"><span class="pre">&lt;算法&gt;:&lt;长度&gt;</span></tt>, 若不指定加密方式encryption,
私钥将以明文保存, 所以通常会使用如aes256的对称加密算法进行私钥的加密, 提高安全性.
如: rsa:3048, ec:2048.</td></tr>
</tbody>
</table>
<p>其他:</p>
<pre class="literal-block">
-x509       直接使用该CSR生成自签名证书, 而不需要第三方CA签名(-out的结果就是证书)
</pre>
</div>
<div class="section" id="ca">
<h3>ca</h3>
<p>作为ca机构对 <cite>证书签名请求文件</cite> 进行签名</p>
<table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-c<var>ert</var></span></kbd></td>
<td>使用的证书</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-k<var>eyfile</var></span></kbd></td>
<td>使用的私钥</td></tr>
</tbody>
</table>
</div>
<div class="section" id="x509">
<h3>x509</h3>
<p>X.509证书格式相关操作。如签名CSR生成证书、签名其他证书等。</p>
<table class="docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">-C<var>Aform</var></span></kbd></td>
<td>指定证书格式</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-C<var>A</var></span></kbd></td>
<td>ca机构所使用的证书, 需要为PEM格式, 否则需用-CAform指定格式</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-C<var>Akeyform</var></span></kbd></td>
<td>指定密钥格式</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-C<var>Akey</var></span></kbd></td>
<td>ca机构所使用的私钥, 需要为PEM格式, 否则需用-CAkeyform指定格式</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-d<var>ays</var></span></kbd></td>
<td>指定证书有效期</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-s<var>ignkey</var></span></kbd></td>
<td>自签名时, 使用此选项指定ca密钥</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-t<var>ext</var></span></kbd></td>
<td>输出证书信息</td></tr>
<tr><td class="option-group">
<kbd><span class="option">-n<var>oout</var></span></kbd></td>
<td>不输出证书, 一般与 -text一起使用</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">-C<var>Acreateserial</var></span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>在签发新证书时自动创建证书序列号文件
为了简化 OpenSSL 中证书签发流程,自动完成序列号文件的创建
(在ubuntu上测试时srl后缀的文件)</td></tr>
</tbody>
</table>
<p>例如查看证书信息:</p>
<pre class="literal-block">
openssl x509 -in xxx.crt -text -noout
</pre>
</div>
<div class="section" id="version">
<h3>version</h3>
<p>查看版本及相关信息</p>
<p>如linux查看openssl安装目录(不适用mac):</p>
<pre class="literal-block">
openssl version -a | grep OPENSSLDIR
</pre>
</div>
</div>
<div class="section" id="mac-ssl">
<h2>用例: Mac 上制作 SSL 证书</h2>
<p>背景: 搭建burpsuite服务时，可选使用证书</p>
<p>环境: MacOS 12.5, openssl</p>
<p>生成rsa私钥，des3算法，1024位强度，ssl.key是秘钥文件名:</p>
<pre class="literal-block">
openssl genrsa -des3 -out ssl.key 1024
</pre>
<p>根据提示输入密码。当前文件夹下生成一个 ssl.key 文件。</p>
<p>删除密码, 这里目录和生成私钥的目录一致:</p>
<pre class="literal-block">
openssl rsa -in ssl.key -out ssl.key
</pre>
<p>生成 CSR（证书签名请求）. 根据根据刚刚生成的 key 文件来生成证书请求文件:</p>
<pre class="literal-block">
openssl req -new -key ssl.key -out ssl.csr
</pre>
<p>依次输入国家、地区、城市、组织、组织单位、Common Name、Email 和密码。
其中 Common Name 应该与域名保持一致。密码我们已经删掉了,直接回车即可。</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">Common Name 就是证书对应的域名地址，我们开发微信小程序时必须要让我们的外链的 https 的域名和证书统一才行。</p>
</div>
<p>生成自签名证书。根据以上 2 个文件生成 crt 证书文件，终端执行下面命令:</p>
<pre class="literal-block">
openssl x509 -req -days 3650 -in ssl.csr -signkey ssl.key -out ssl.crt
</pre>
<p>这里3650是证书有效期(单位：天)。这个大家随意。最后使用到的文件是key和crt文件。
到这里我们的证书(ssl.key 和 ssl.crt) 就已经创建成功了可以直接用到 https 的 server 中了。</p>
<p>在代码中使用证书:</p>
<pre class="literal-block">
https
    .createServer(
        {
            key: fs.readFileSync(&quot;./cert_key/ssl.key&quot;),
            cert: fs.readFileSync(&quot;./cert_key/ssl.crt&quot;)
        },
        app
    )
    .listen(1993);
</pre>
</div>
<div class="section" id="section-6">
<h2>详情介绍</h2>
<p>见:</p>
</div>

								</article>
						</div>
					</div>
				</div>
			</section>
	</div>
</div>

				</div>
			</div>

		<!-- Footer Wrapper -->
			<div id="footer-wrapper">
				<!-- Footer -->
					<section id="footer" class="container">
						<div class="row">
							<div class="8u">
								<section>
									<header>
										<h2>Latest articles</h2>
									</header>
									<ul class="dates">
										<li>
											<span class="date"> 3 <strong>21</strong></span>
											<h3><a href="yq-doc-source-docs-front-end-frame-jquery-jQuery-provided-methods.html">jQuery提供方法</a></h3>
											<p><p class="first last">jQuery提供常用方法/函数</p>
</p>
										</li>
										<li>
											<span class="date"> 3 <strong>19</strong></span>
											<h3><a href="yq-doc-source-docs-version-control-git-issuses-clone-only-folder.html">仅克隆指定文件夹</a></h3>
											<p><p class="first last">当前模块或子模块仅克隆指定文件夹</p>
</p>
										</li>
										<li>
											<span class="date"> 3 <strong>19</strong></span>
											<h3><a href="yq-doc-source-docs-rear-end-python-python-three--party-library-googletrans.html">googletrans</a></h3>
											<p><p class="first last">python实现翻译功能</p>
</p>
										</li>
										<li>
											<span class="date"> 3 <strong>18</strong></span>
											<h3><a href="yq-os-linux-ubuntu-issues.html">gnome刷新desktop缓存</a></h3>
											<p><p class="first last">gnome图标文件缓存刷新</p>
</p>
										</li>
									</ul>
								</section>
							</div>
						</div>
						<div class="row">
							<div class="4u">
								<section>
									<header>
										<h2>Blogroll</h2>
									</header>
									<ul class="divided">
											<li><a href="https://yq-yqr.readthedocs.io/zh/blog-theme/blog.html">旧版(迁移中)</a></li>
											<li><a href="https://getpelican.com/">Pelican</a></li>
											<li><a href="https://www.python.org/">Python.org</a></li>
											<li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
									</ul>
								</section>
							</div>
							<div class="4u">
								<section>
									<header>
										<h2>Categories</h2>
									</header>
									<ul class="divided">
											<li><a href="/category/ai.html">AI</a></li>
											<li><a href="/category/an-quan.html">安全</a></li>
											<li><a href="/category/ban-ben-kong-zhi.html">版本控制</a></li>
											<li><a href="/category/cao-zuo-xi-tong.html">操作系统</a></li>
									</ul>
								</section>
							</div>

							<div class="4u">
								<section>
									<header>
										<h2>SITEMAP</h2>
									</header>

									<ul class="divided">
												<li><a href="/authors.html">作者</a></li>
												<li><a href="/categories.html">分类</a></li>
												<li><a href="/archives.html">归档</a></li>
												<li><a href="/tags.html">标签</a></li>
									</ul>
								</section>
							</div>

							<div class="4u">

								<section>
									<header>
										<h2>Contact</h2>
									</header>
									<ul class="social">
									</ul>
								</section>
							</div>
						</div>
						<div class="row">
							<div class="12u">
								<!-- Copyright -->
									<div id="copyright">
										<ul class="links">
											<li>&copy; YanQue 2021-2024	</li>
											<!-- <li>Images: <a href="http://facebook.com/DreametryDoodle">Dreametry Doodle</a> + <a href="http://iconify.it">Iconify.it</a></li>
											<li>Design: <a href="http://html5up.net">HTML5 UP</a></li> -->
										</ul>
									</div>
							</div>
						</div>
					</section>
			</div>
		<script src="/theme/js/jquery.min.js"></script>
		<script src="/theme/js/jquery.dropotron.js"></script>
		<script src="/theme/js/config.js"></script>
		<script src="/theme/js/skel.min.js"></script>
		<script src="/theme/js/skel-panels.min.js"></script>
		<!--[if lte IE 8]><script src="js/html5shiv.js"></script><link rel="stylesheet" href="/theme/css/ie8.css" /><![endif]-->
	</body>
</html>