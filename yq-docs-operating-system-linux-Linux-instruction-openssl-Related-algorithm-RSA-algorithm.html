
<!DOCTYPE HTML>
<!--
	Dopetrope 2.0 by HTML5 UP
	html5up.net | @n33co
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html data-theme="dark">
	<head>
			<title>书言</title>
			<meta http-equiv="content-type" content="text/html; charset=utf-8" />
			<meta charset="utf-8" />

			<!-- <link href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,900,300italic" rel="stylesheet" /> -->
			<link rel="stylesheet" href="/theme/css/pygment.css" />
			<link rel="stylesheet" href="/theme/css/custom-pygment.css" />
			<noscript>
				<link rel="stylesheet" href="/theme/css/skel-noscript.css" />
				<link rel="stylesheet" href="/theme/css/style.css" />
				<link rel="stylesheet" href="/theme/css/style-desktop.css" />
			</noscript>

		<!-- tipuesearch 放在这, 因为搜索框是全局定义的 -->
		<link rel="stylesheet" href="/theme//Tipue-Search-5.0.0/tipuesearch.css" />
		<link rel="stylesheet" href="/theme//Tipue-Search-5.0.0/custom/tipuesearch-custom.css" />
		<link rel="stylesheet" href="/theme/css/alabaster.css" />
		<!-- <link rel="stylesheet" href="/theme/fontawesome-free-6.5.1-web/css/all.min.css" /> -->
		<!--  <link rel="preload" as="font" type="font/woff2" crossorigin href="/theme/fontawesome-free-6.5.1-web/webfonts/fa-brands-400.woff2" />
		<link rel="preload" as="font" type="font/woff2" crossorigin href="/theme/fontawesome-free-6.5.1-web/webfonts/fa-regular-400.woff2" />
		<link rel="preload" as="font" type="font/woff2" crossorigin href="/theme/fontawesome-free-6.5.1-web/webfonts/fa-solid-900.woff2" />
		<link rel="preload" as="font" type="font/woff2" crossorigin href="/theme/fontawesome-free-6.5.1-web/webfonts/fa-v4compatibility.woff2" /> -->


	</head>
	<body class="no-sidebar">
		<!-- Header Wrapper -->
			<div id="header-wrapper">
				<div class="container">
					<div class="row">
						<div class="12u">

							<!-- Header -->
								<section id="header">

									<!-- Logo -->
									<div class="page-home">
										<h1><a href="/">HOME</a></h1>
									</div>

									<!-- Nav -->
									<div class="page-menu">
										<nav id="nav">
											<ul>

												<!-- categories -->
														<li ><a href="/category/ai.html">AI</a></li>
														<li ><a href="/category/an-quan.html">安全</a></li>
														<li ><a href="/category/ban-ben-kong-zhi.html">版本控制</a></li>
														<li  class="active"><a href="/category/cao-zuo-xi-tong.html">操作系统</a></li>
														<li ><a href="/category/chang-yong-gong-ju-shi-yong.html">常用工具使用</a></li>
														<li ><a href="/category/da-shu-ju.html">大数据</a></li>
														<li><a href="/categories.html">More...</a></li>
											</ul>
										</nav>
									</div>
								</section>

						</div>
					</div>
					<div class="row page-head-search">
						<form class="navbar-search" action="/search.html" role="search">
							<!-- <button class="fa-solid fa-magnifying-glass" type="submit"></button> -->
							<button type="submit"></button>
							<input type="text" name="q" id="tipue_search_input" autocomplete="off" placeholder="Search...">
							<!-- <i class="fa-solid fa-magnifying-glass"></i> -->
						</form>
					</div>
  <div class="row page-head page-article persistent">
    <div class="page-head-title">
      <h2>RSA算法</h2>
    </div>
    <div class="page-head-content">
      By
	  <a href="author/yanque.html">YanQue</a>
      , 20 二月 2023
      , Category:
	  <a href="category/cao-zuo-xi-tong.html">操作系统</a>
    </div>
	<div class="red-line">
    </div>
  </div>
				</div>
			</div>


		<!-- Main Wrapper -->
			<div id="main-wrapper">
				<div class="container">
<div class="row">
	<div class="12u">
			<section>
				<div>
					<div class="row">
						<div class="12u skel-cell-mainContent">
							<!-- Content -->
								<article class="box is-post">
									<div class="box-head">
										<div class="post-infos">
											<ul class="tags">
												<li><a class="button" href="category/cao-zuo-xi-tong.html">操作系统</a></li>
													<li><a class="button button-alt" href="tag/linux.html">Linux</a></li>

													<li><a class="button button-alt" href="tag/linuxzhi-ling.html">Linux指令</a></li>

													<li><a class="button button-alt" href="tag/openssl.html">Openssl</a></li>

													<li><a class="button button-alt" href="tag/xiang-guan-suan-fa.html">相关算法</a></li>

											</ul>
										</div>

										<div class="pennant pennant-alt date">2023-02-20</div>
										<h2>RSA算法</h2>

										<span class="head-modify-time">修改于: 2023-02-20</span>

									</div>
									<p>参考:</p>
<ul class="simple">
<li><a class="reference external" href="https://zhuanlan.zhihu.com/p/48249182">https://zhuanlan.zhihu.com/p/48249182</a> (RSA这个写的比较详细, 但是看着头疼, 后面有空继续看)</li>
<li><a class="reference external" href="https://www.openssl.net.cn/docs/3.html">https://www.openssl.net.cn/docs/3.html</a> (这个是详细的中文说明, 没空看)</li>
</ul>
<p>属于 <strong>公钥加密算法</strong>、 <strong>非对称加密算法</strong></p>
<div class="section" id="section-1">
<h2>模运算</h2>
<p>模运算即求余运算。“模”是“Mod”的音译。
和模运算紧密相关的一个概念是“同余”。
数学上，当两个整数除以同一个正整数，若得相同余数，则二整数同余。</p>
<p>两个整数a，b，若它们除以正整数m所得的余数相等，则称a，b对于模m同余，记作:</p>
<pre class="literal-block">
a ≡ b (mod m)
</pre>
<p>读作：a同余于b模m，或者，a与b关于模m同余。例如:</p>
<pre class="literal-block">
26 ≡ 14 (mod 12)。
</pre>
</div>
<div class="section" id="section-2">
<h2>互质关系</h2>
<p>如果两个正整数，除了1以外，没有其他公因子，我们就称这两个数是互质关系（coprime）。
比如，15和32没有公因子，所以它们是互质关系。这说明，不是质数也可以构成互质关系。</p>
<dl class="docutils" id="target-1">
<dt>关于互质关系，不难得到以下结论：</dt>
<dd><ol class="first last loweralpha simple">
<li>任意两个质数构成互质关系，比如13和61。</li>
<li>一个数是质数，另一个数只要不是前者的倍数，两者就构成互质关系，比如3和10。</li>
<li>如果两个数之中，较大的那个数是质数，则两者构成互质关系，比如97和57。</li>
<li>1和任意一个自然数是都是互质关系，比如1和99。</li>
<li>p是大于1的整数，则p和p-1构成互质关系，比如57和56。</li>
<li>p是大于1的奇数，则p和p-2构成互质关系，比如17和15。</li>
</ol>
</dd>
</dl>
</div>
<div class="section" id="section-3">
<h2>欧拉函数</h2>
<dl class="docutils">
<dt>思考以下问题::</dt>
<dd>任意给定正整数n，请问在小于等于n的正整数之中，有多少个与n构成互质关系？（比如，在1到8之中，有多少个数与8构成互质关系？）</dd>
</dl>
<p>计算这个值的方法就叫做欧拉函数，以φ(n)表示。在1到8之中，与8形成互质关系的是1、3、5、7，所以 φ(n) = 4。</p>
<div class="section" id="section-4">
<h3>第一种情况</h3>
<p>如果n=1，则 φ(1) = 1 。因为1与任何数（包括自身）都构成互质关系。</p>
</div>
<div class="section" id="section-5">
<h3>第二种情况</h3>
<p>如果n是质数，则 φ(n)=n-1 。因为质数与小于它的每一个数，都构成互质关系。比如5与1、2、3、4都构成互质关系。</p>
</div>
<div class="section" id="section-6">
<h3>第三种情况</h3>
<p>如果n是质数的某一个次方，即 n = p^k (p为质数，k为大于等于1的整数)，则</p>
<div class="formula">
<i>φ</i>(<i>n</i>) = <i>φ</i>(<i>p</i><sup><i>k</i></sup>) = <i>p</i><sup><i>k</i></sup> − <i>p</i><sup><i>k</i> − 1</sup>
</div>
<p>比如:</p>
<pre class="literal-block">
φ(8) = φ(2^3) =2^3 - 2^2 = 8 -4 = 4。
</pre>
<p>这是因为只有当一个数不包含质数p(包含是指是质数p的倍数)，
才可能与n互质(因为若一个数包含质数p, 则不满足 <a class="reference internal" href="#target-1">互质关系结论</a> 第二点).</p>
<p>而包含质数p的数一共有p^(k-1)个，即1×p、2×p、3×p、...、p^(k-1)×p, 这里可以推导:</p>
<pre class="literal-block">
- 第一个数是1xp, 是第一个
- 第二个数是2xp, 是第二个
- \.\.\.
- 最后一个数是p^(k-1)×p, 是第p^(k-1)个
</pre>
<p>故一共有 <tt class="docutils literal"><span class="pre">p^(k-1)</span></tt> 个包含p的数.</p>
<p>把它们去除，剩下的就是与n互质的数。
上面的式子还可以写成下面的形式:</p>
<div class="formula">
<i>φ</i>(<i>n</i>) = <i>φ</i>(<i>p</i><sup><i>k</i></sup>) = <i>p</i><sup><i>k</i></sup> − <i>p</i><sup><i>k</i> − 1</sup> = <i>p</i><sup><i>k</i></sup>(1 − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator"><i>p</i></span><span class="ignored">)</span></span>)
</div>
<p>可以看出，上面的第二种情况是 k=1 时的特例。</p>
</div>
<div class="section" id="section-7">
<h3>第四种情况</h3>
<p>如果n可以分解成两个互质的整数之积:</p>
<pre class="literal-block">
n = p1 × p2
</pre>
<p>则:</p>
<pre class="literal-block">
φ(n) = φ(p1p2) = φ(p1)φ(p2)
</pre>
<p>即积的欧拉函数等于各个因子的欧拉函数之积。比如:</p>
<pre class="literal-block">
φ(56)=φ(8×7)=φ(8)×φ(7)=4×6=24。
</pre>
<p>这一条的证明要用到“中国剩余定理”，这里就不展开了，只简单说一下思路:</p>
<p>如果a与p1互质(a &lt; p1)，b与p2互质(b &lt; p2)，c与p1p2互质(c &lt; p1p2)，则c与数对 (a,b) 是一一对应关系。
由于a的值有φ(p1)种可能，b的值有φ(p2)种可能，则数对 (a,b) 有φ(p1)φ(p2)种可能，而c的值有φ(p1p2)种可能，
所以φ(p1p2)就等于φ(p1)φ(p2)。</p>
</div>
<div class="section" id="section-8">
<h3>第五种情况</h3>
<p>因为任意一个大于1的正整数，都可以写成一系列质数的积</p>
<div class="formula">
<i>n</i> = <i>p</i><span class="scripts"><sup class="script"><i>k</i>1</sup><sub class="script">1</sub></span><i>p</i><span class="scripts"><sup class="script"><i>k</i>2</sup><sub class="script">2</sub></span>...<i>p</i><span class="scripts"><sup class="script"><i>kr</i></sup><sub class="script"><i>r</i></sub></span>
</div>
<p>根据 <a class="reference internal" href="#section-7">第四种情况</a> 结论，得到</p>
<div class="formula">
<i>φ</i>(<i>n</i>) = <i>φ</i>(<i>p</i><span class="scripts"><sup class="script"><i>k</i>1</sup><sub class="script">1</sub></span>)<i>φ</i>(<i>p</i><span class="scripts"><sup class="script"><i>k</i>2</sup><sub class="script">2</sub></span>)...<i>φ</i>(<i>p</i><span class="scripts"><sup class="script"><i>kr</i></sup><sub class="script"><i>r</i></sub></span>)
</div>
<p>再根据 <a class="reference internal" href="#section-6">第三种情况</a> 的结论，得到</p>
<div class="formula">
<i>φ</i>(<i>n</i>) = <i>p</i><span class="scripts"><sup class="script"><i>k</i>1</sup><sub class="script">1</sub></span>(1 − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator"><i>p</i><sub>1</sub></span><span class="ignored">)</span></span>)<i>p</i><span class="scripts"><sup class="script"><i>k</i>2</sup><sub class="script">2</sub></span>(1 − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator"><i>p</i><sub>2</sub></span><span class="ignored">)</span></span>)...<i>p</i><span class="scripts"><sup class="script"><i>kr</i></sup><sub class="script"><i>r</i></sub></span>(1 − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator"><i>p</i><sub><i>r</i></sub></span><span class="ignored">)</span></span>)
</div>
<p>也就等于</p>
<div class="formula">
<i>φ</i>(<i>n</i>) = <i>n</i>(1 − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator"><i>p</i><sub>1</sub></span><span class="ignored">)</span></span>)(1 − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator"><i>p</i><sub>2</sub></span><span class="ignored">)</span></span>)...(1 − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator"><i>p</i><sub><i>r</i></sub></span><span class="ignored">)</span></span>)
</div>
<p>这就是欧拉函数的通用计算公式。比如，1323的欧拉函数，计算过程如下</p>
<div class="formula">
<i>φ</i>(1323) = <i>φ</i>(3<sup>3</sup><i>x</i>7<sup>2</sup>) = 1323(1 − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">3</span><span class="ignored">)</span></span>)(1 − <span class="fraction"><span class="ignored">(</span><span class="numerator">1</span><span class="ignored">)/(</span><span class="denominator">7</span><span class="ignored">)</span></span>) = 756
</div>
</div>
</div>
<div class="section" id="section-9">
<h2>欧拉定理</h2>
<p>欧拉函数的用处，在于欧拉定理。”欧拉定理”指的是: 如果两个正整数a和n互质，则n的欧拉函数 φ(n) 可以让下面的等式成立</p>
<div class="formula">
<i>a</i><sup><i>φ</i>(<i>n</i>)</sup> ≡ 1 (<i>mod</i> <i>n</i>)
</div>
<p>也就是说，a的φ(n)次方被n除的余数为1。或者说，a的φ(n)次方减去1，可以被n整除。
比如，3和7互质，而7的欧拉函数φ(7)等于6，所以3的6次方（729）减去1，可以被7整除（728/7=104）。</p>
<p>欧拉定理有一个特殊情况。
<cite>假设正整数a与质数p互质，因为质数p的φ(p)等于p-1，则欧拉定理可以写成</cite></p>
<div class="formula">
<i>a</i><sup><i>p</i> − 1</sup> ≡ 1 (<i>mod</i> <i>p</i>)
</div>
<p>这就是著名的费马小定理。它是欧拉定理的特例。</p>
<p>欧拉定理是RSA算法的核心。理解了这个定理，就可以理解RSA。</p>
</div>
<div class="section" id="section-10">
<h2>模反元素</h2>
<p>还剩下最后一个概念：
<cite>如果两个正整数a和n互质，那么一定可以找到整数b，使得ab-1被n整除，或者说ab被n除的余数是1.</cite></p>
<p>这时，b就叫做a的“模反元素”。</p>
<p>比如，3和11互质，那么3的模反元素就是4，因为 (3 × 4)-1 可以被11整除。
显然，模反元素不止一个， 4加减11的整数倍都是3的模反元素 {…,-18,-7,4,15,26,…}，
即如果b是a的模反元素，则 b+kn 都是a的模反元素。</p>
<p>欧拉定理可以用来证明模反元素必然存在。</p>
<p>可以看到，a的 φ(n)-1 次方，就是a的模反元素。</p>
</div>
<div class="section" id="rsa-1">
<span id="r-rsa"></span><h2>RSA生成算法</h2>
<p>具体来说:</p>
<ol class="loweralpha simple">
<li>选择两个大素数p和q,计算n=pq,且欧拉函数φ(n)=(p-1)(q-1)</li>
<li>选择与φ(n)互质的整数e,e就是公钥指数</li>
<li>计算d,满足ed≡1(mod φ(n)),d就是私钥指数</li>
<li>(n,e)就是公钥,(n,d)就是私钥</li>
</ol>
<p>这里公钥(n,e)是从私钥(n,d)推导计算出来的,而无法由公钥反推私钥。</p>
<p>举个简单例子:</p>
<pre class="literal-block">
p=5,q=7
n=5*7=35
φ(n)=(p-1)(q-1)=4*6=24
</pre>
<p>选择e=7,与24互质, 则d=7的乘法逆元mod 24=29, 则:</p>
<ul class="simple">
<li>公钥(n=35, e=7)</li>
<li>私钥(n=35, d=29)</li>
</ul>
<p>可以看出,公钥是从选择的d计算得到的e,但无法由e反推出d。
所以,RSA算法要求私钥生成公钥,而不能由公钥生成私钥,这是RSA算法的基本原理和要求。</p>
</div>

								</article>
						</div>
					</div>
				</div>
			</section>
	</div>
</div>

				</div>
			</div>

		<!-- Sider Bar -->
		<div id="right-side-bar">
	<nav>
		<div id="top-toc-tree-container" class="fixed-container">
			<div class="toc-contents-title">
				<h4 id="toc-contents-title-text">Contents</h4>
				<!-- <span class="tool-tip-text">点击隐藏</span> -->
			</div>
			<div id="toc-tree-container">
 <ul class="toc-tree visible">
  <li class="toc-h0">
   <a class="" href="#section-1">
    模运算
   </a>
  </li>
  <li class="toc-h0">
   <a class="" href="#section-2">
    互质关系
   </a>
  </li>
  <li class="toc-h0">
   <a class="" href="#section-3">
    欧拉函数
   </a>
   <ul class="toc-tree visible">
    <li class="toc-h1">
     <a class="" href="#section-4">
      第一种情况
     </a>
    </li>
    <li class="toc-h1">
     <a class="" href="#section-5">
      第二种情况
     </a>
    </li>
    <li class="toc-h1">
     <a class="" href="#section-6">
      第三种情况
     </a>
    </li>
    <li class="toc-h1">
     <a class="" href="#section-7">
      第四种情况
     </a>
    </li>
    <li class="toc-h1">
     <a class="" href="#section-8">
      第五种情况
     </a>
    </li>
   </ul>
  </li>
  <li class="toc-h0">
   <a class="" href="#section-9">
    欧拉定理
   </a>
  </li>
  <li class="toc-h0">
   <a class="" href="#section-10">
    模反元素
   </a>
  </li>
  <li class="toc-h0">
   <a class="" href="#rsa-1">
    RSA生成算法
   </a>
  </li>
 </ul>
</div>

		</div>
	</nav>
	<div id="sidebar-tools" class="fixed-container no-active cant-select">
		<!-- 按钮 使用 content 绘制图标 -->
	</div>
	<div id="sidebar-tool-back-top" class="fixed-container cant-select">
		<!-- 按钮 使用 content 绘制图标 -->
	</div>
		</div>

		<!-- Footer Wrapper -->
			<div id="footer-wrapper">
				<!-- Footer -->
					<section id="footer" class="container">
						<div class="row">
							<div class="8u">
								<section>
									<header>
										<h2>Latest articles</h2>
									</header>
									<ul class="dates">
										<li>
											<span class="date"> 4 <strong>26</strong></span>
											<h3><a href="yq-docs-front-end-node-Three--party-library-js-yaml.html">js-yaml</a></h3>
											<p><p class="first last">前端操作yaml</p>
</p>
										</li>
										<li>
											<span class="date"> 4 <strong>26</strong></span>
											<h3><a href="yq-docs-front-end-tutorial-index.html">前端教程</a></h3>
											<p><p class="first last">前端教程集合</p>
</p>
										</li>
										<li>
											<span class="date"> 3 <strong>09</strong></span>
											<h3><a href="yq-docs-front-end-Open-source-icon-library.html">开源图标/字体库</a></h3>
											<p><p class="first last">开源图标/字体库</p>
</p>
										</li>
										<li>
											<span class="date"> 3 <strong>09</strong></span>
											<h3><a href="yq-docs-operating-system-Windows-Windows-program-packaging.html">windows执行程序打包</a></h3>
											<p><p class="first last">as title</p>
</p>
										</li>
									</ul>
								</section>
							</div>
						</div>
						<div class="row">
							<div class="4u">
								<section>
									<header>
										<h2>Blogroll</h2>
									</header>
									<ul class="divided">
											<li><a href="https://yq-yqr.readthedocs.io/zh/blog-theme/blog.html">旧版(迁移中)</a></li>
											<li><a href="https://getpelican.com/">Pelican</a></li>
											<li><a href="https://www.python.org/">Python.org</a></li>
											<li><a href="https://palletsprojects.com/p/jinja/">Jinja2</a></li>
									</ul>
								</section>
							</div>
							<div class="4u">
								<section>
									<header>
										<h2>Categories</h2>
									</header>
									<ul class="divided">
											<li><a href="/category/ai.html">AI</a></li>
											<li><a href="/category/an-quan.html">安全</a></li>
											<li><a href="/category/ban-ben-kong-zhi.html">版本控制</a></li>
											<li><a href="/category/cao-zuo-xi-tong.html">操作系统</a></li>
									</ul>
								</section>
							</div>

							<div class="4u">
								<section>
									<header>
										<h2>SITEMAP</h2>
									</header>

									<ul class="divided">
												<li><a href="/authors.html">作者</a></li>
												<li><a href="/categories.html">分类</a></li>
												<li><a href="/archives.html">归档</a></li>
												<li><a href="/tags.html">标签</a></li>
									</ul>
								</section>
							</div>

							<div class="4u">

								<section>
									<header>
										<h2>Contact</h2>
									</header>
									<ul class="social">
									</ul>
								</section>
							</div>
						</div>
						<div class="row">
							<div class="12u">
								<!-- Copyright -->
									<div id="copyright">
										<ul class="links">
											<li>&copy; YanQue 2021-2024	</li>
											<!-- <li>Images: <a href="http://facebook.com/DreametryDoodle">Dreametry Doodle</a> + <a href="http://iconify.it">Iconify.it</a></li>
											<li>Design: <a href="http://html5up.net">HTML5 UP</a></li> -->
										</ul>
									</div>
							</div>
						</div>
					</section>
			</div>
		<script src="/theme/js/jquery-3.7.1.min.js"></script>
		<script src="/theme/js/jquery.dropotron.js"></script>
		<script src="/theme/js/config.js"></script>
		<script src="/theme/skel-s0.4.8/skel.min.js"></script>
		<script src="/theme/skel-s0.4.8/skel-panels.min.js"></script>
		<!-- <script src="/theme/js/skel.min.js"></script>
		<script src="/theme/js/skel-panels.min.js"></script> -->
		<script src="/theme/js/backloading.js"></script>
<script type="text/javascript">
	function addEvent() {
		$("#toc-contents-title-text").click(function() {
			$("#top-toc-tree-container").toggleClass("no-active");
			$("#sidebar-tools").toggleClass("no-active");
		})
		$("#sidebar-tools").click(function() {
			$("#top-toc-tree-container").toggleClass("no-active");
			$("#sidebar-tools").toggleClass("no-active");
		})
		$("#sidebar-tool-back-top").click(function() {
			// window.scrollTo(0, 0);
			window.scrollTo({
				top: 0,
				left: 0,
				behavior: 'smooth'
			});
		})
	}
	addEvent()
</script>
		<!--[if lte IE 8]><script src="js/html5shiv.js"></script><link rel="stylesheet" href="/theme/css/ie8.css" /><![endif]-->
	</body>
</html>